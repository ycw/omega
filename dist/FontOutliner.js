import{ShapePath as r}from"three";function e(r,e,t,a){if("a"===t&&!a)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?r!==e||!a:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===t?a:"a"===t?a.call(r):a?a.value:e.get(r)}var t,a,n={parse:function(r){var e=function(r,e,t,a){var s=n.T,o={cmap:s.cmap,head:s.head,hhea:s.hhea,maxp:s.maxp,hmtx:s.hmtx,name:s.name,"OS/2":s.OS2,post:s.post,loca:s.loca,kern:s.kern,glyf:s.glyf,"CFF ":s.CFF,"SVG ":s.SVG},i={_data:r,_index:e,_offset:t};for(var h in o){var f=n.findTable(r,h,t);if(f){var d=f[0],l=a[d];null==l&&(l=o[h].parseTab(r,d,f[1],i)),i[h]=a[d]=l}}return i},t=n.B,a=new Uint8Array(r),s={};if("ttcf"==t.readASCII(a,0,4)){var o=4;t.readUshort(a,o),o+=2,t.readUshort(a,o),o+=2;var i=t.readUint(a,o);o+=4;for(var h=[],f=0;f<i;f++){var d=t.readUint(a,o);o+=4,h.push(e(a,f,d,s))}return h}return[e(a,0,0,s)]},findTable:function(r,e,t){for(var a=n.B,s=a.readUshort(r,t+4),o=t+12,i=0;i<s;i++){var h=a.readASCII(r,o,4),f=(a.readUint(r,o+4),a.readUint(r,o+8)),d=a.readUint(r,o+12);if(h==e)return[f,d];o+=16}return null},T:{}};n.B={readFixed:function(r,e){return(r[e]<<8|r[e+1])+(r[e+2]<<8|r[e+3])/65540},readF2dot14:function(r,e){return n.B.readShort(r,e)/16384},readInt:function(r,e){var t=n.B.t.uint8;return t[0]=r[e+3],t[1]=r[e+2],t[2]=r[e+1],t[3]=r[e],n.B.t.int32[0]},readInt8:function(r,e){return n.B.t.uint8[0]=r[e],n.B.t.int8[0]},readShort:function(r,e){var t=n.B.t.uint8;return t[1]=r[e],t[0]=r[e+1],n.B.t.int16[0]},readUshort:function(r,e){return r[e]<<8|r[e+1]},writeUshort:function(r,e,t){r[e]=t>>8&255,r[e+1]=255&t},readUshorts:function(r,e,t){for(var a=[],s=0;s<t;s++){var o=n.B.readUshort(r,e+2*s);a.push(o)}return a},readUint:function(r,e){var t=n.B.t.uint8;return t[3]=r[e],t[2]=r[e+1],t[1]=r[e+2],t[0]=r[e+3],n.B.t.uint32[0]},writeUint:function(r,e,t){r[e]=t>>24&255,r[e+1]=t>>16&255,r[e+2]=t>>8&255,r[e+3]=t>>0&255},readUint64:function(r,e){return 4294967296*n.B.readUint(r,e)+n.B.readUint(r,e+4)},readASCII:function(r,e,t){for(var a="",n=0;n<t;n++)a+=String.fromCharCode(r[e+n]);return a},writeASCII:function(r,e,t){for(var a=0;a<t.length;a++)r[e+a]=t.charCodeAt(a)},readUnicode:function(r,e,t){for(var a="",n=0;n<t;n++){var s=r[e++]<<8|r[e++];a+=String.fromCharCode(s)}return a},_tdec:window.TextDecoder?new window.TextDecoder:null,readUTF8:function(r,e,t){var a=n.B._tdec;return a&&0==e&&t==r.length?a.decode(r):n.B.readASCII(r,e,t)},readBytes:function(r,e,t){for(var a=[],n=0;n<t;n++)a.push(r[e+n]);return a},readASCIIArray:function(r,e,t){for(var a=[],n=0;n<t;n++)a.push(String.fromCharCode(r[e+n]));return a},t:(t=new ArrayBuffer(8),{buff:t,int8:new Int8Array(t),uint8:new Uint8Array(t),int16:new Int16Array(t),uint16:new Uint16Array(t),int32:new Int32Array(t),uint32:new Uint32Array(t)})},n.T.CFF={parseTab:function(r,e,t){var a=n.B,s=n.T.CFF;(r=new Uint8Array(r.buffer,e,t))[e=0],r[++e],r[++e],r[++e],e++;var o=[];e=s.readIndex(r,e,o);for(var i=[],h=0;h<o.length-1;h++)i.push(a.readASCII(r,e+o[h],o[h+1]-o[h]));e+=o[o.length-1];var f=[];e=s.readIndex(r,e,f);var d=[];for(h=0;h<f.length-1;h++)d.push(s.readDict(r,e+f[h],e+f[h+1]));e+=f[f.length-1];var l=d[0],u=[];e=s.readIndex(r,e,u);var c=[];for(h=0;h<u.length-1;h++)c.push(a.readASCII(r,e+u[h],u[h+1]-u[h]));if(e+=u[u.length-1],s.readSubrs(r,e,l),l.CharStrings&&(l.CharStrings=s.readBytes(r,l.CharStrings)),l.ROS){e=l.FDArray;var v=[];for(e=s.readIndex(r,e,v),l.FDArray=[],h=0;h<v.length-1;h++){var p=s.readDict(r,e+v[h],e+v[h+1]);s._readFDict(r,p,c),l.FDArray.push(p)}e+=v[v.length-1],e=l.FDSelect,l.FDSelect=[];var g=r[e];if(e++,3!=g)throw g;var m=a.readUshort(r,e);for(e+=2,h=0;h<m+1;h++)l.FDSelect.push(a.readUshort(r,e),r[e+2]),e+=3}return l.charset&&(l.charset=s.readCharset(r,l.charset,l.CharStrings.length)),s._readFDict(r,l,c),l},_readFDict:function(r,e,t){var a,s=n.T.CFF;for(var o in e.Private&&(a=e.Private[1],e.Private=s.readDict(r,a,a+e.Private[0]),e.Private.Subrs&&s.readSubrs(r,a+e.Private.Subrs,e.Private)),e)-1!=["FamilyName","FontName","FullName","Notice","version","Copyright"].indexOf(o)&&(e[o]=t[e[o]-426+35])},readSubrs:function(r,e,t){t.Subrs=n.T.CFF.readBytes(r,e);var a,s=t.Subrs.length+1;a=s<1240?107:s<33900?1131:32768,t.Bias=a},readBytes:function(r,e){var t=[];e=n.T.CFF.readIndex(r,e,t);for(var a=[],s=t.length-1,o=r.byteOffset+e,i=0;i<s;i++){var h=t[i];a.push(new Uint8Array(r.buffer,o+h,t[i+1]-h))}return a},tableSE:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,0,111,112,113,114,0,115,116,117,118,119,120,121,122,0,123,0,124,125,126,127,128,129,130,131,0,132,133,0,134,135,136,137,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,138,0,139,0,0,0,0,140,141,142,143,0,0,0,0,0,144,0,0,0,145,0,0,146,147,148,149,0,0,0,0],glyphByUnicode:function(r,e){for(var t=0;t<r.charset.length;t++)if(r.charset[t]==e)return t;return-1},glyphBySE:function(r,e){return e<0||e>255?-1:n.T.CFF.glyphByUnicode(r,n.T.CFF.tableSE[e])},readCharset:function(r,e,t){var a=n.B,s=[".notdef"],o=r[e];if(e++,0==o)for(var i=0;i<t;i++){var h=a.readUshort(r,e);e+=2,s.push(h)}else{if(1!=o&&2!=o)throw"error: format: "+o;for(;s.length<t;){h=a.readUshort(r,e),e+=2;var f=0;for(1==o?(f=r[e],e++):(f=a.readUshort(r,e),e+=2),i=0;i<=f;i++)s.push(h),h++}}return s},readIndex:function(r,e,t){var a=n.B,s=a.readUshort(r,e)+1,o=r[e+=2];if(e++,1==o)for(var i=0;i<s;i++)t.push(r[e+i]);else if(2==o)for(i=0;i<s;i++)t.push(a.readUshort(r,e+2*i));else if(3==o)for(i=0;i<s;i++)t.push(16777215&a.readUint(r,e+3*i-1));else if(4==o)for(i=0;i<s;i++)t.push(a.readUint(r,e+4*i));else if(1!=s)throw"unsupported offset size: "+o+", count: "+s;return(e+=s*o)-1},getCharString:function(r,e,t){var a=n.B,s=r[e],o=r[e+1],i=(r[e+2],r[e+3],r[e+4],1),h=null,f=null;s<=20&&(h=s,i=1),12==s&&(h=100*s+o,i=2),21<=s&&s<=27&&(h=s,i=1),28==s&&(f=a.readShort(r,e+1),i=3),29<=s&&s<=31&&(h=s,i=1),32<=s&&s<=246&&(f=s-139,i=1),247<=s&&s<=250&&(f=256*(s-247)+o+108,i=2),251<=s&&s<=254&&(f=256*-(s-251)-o-108,i=2),255==s&&(f=a.readInt(r,e+1)/65535,i=5),t.val=null!=f?f:"o"+h,t.size=i},readCharString:function(r,e,t){for(var a=e+t,s=n.B,o=[];e<a;){var i=r[e],h=r[e+1],f=(r[e+2],r[e+3],r[e+4],1),d=null,l=null;i<=20&&(d=i,f=1),12==i&&(d=100*i+h,f=2),19!=i&&20!=i||(d=i,f=2),21<=i&&i<=27&&(d=i,f=1),28==i&&(l=s.readShort(r,e+1),f=3),29<=i&&i<=31&&(d=i,f=1),32<=i&&i<=246&&(l=i-139,f=1),247<=i&&i<=250&&(l=256*(i-247)+h+108,f=2),251<=i&&i<=254&&(l=256*-(i-251)-h-108,f=2),255==i&&(l=s.readInt(r,e+1)/65535,f=5),o.push(null!=l?l:"o"+d),e+=f}return o},readDict:function(r,e,t){for(var a=n.B,s={},o=[];e<t;){var i=r[e],h=r[e+1],f=(r[e+2],r[e+3],r[e+4],1),d=null,l=null;if(28==i&&(l=a.readShort(r,e+1),f=3),29==i&&(l=a.readInt(r,e+1),f=5),32<=i&&i<=246&&(l=i-139,f=1),247<=i&&i<=250&&(l=256*(i-247)+h+108,f=2),251<=i&&i<=254&&(l=256*-(i-251)-h-108,f=2),255==i)throw l=a.readInt(r,e+1)/65535,f=5,"unknown number";if(30==i){var u=[];for(f=1;;){var c=r[e+f];f++;var v=c>>4,p=15&c;if(15!=v&&u.push(v),15!=p&&u.push(p),15==p)break}for(var g="",m=[0,1,2,3,4,5,6,7,8,9,".","e","e-","reserved","-","endOfNumber"],y=0;y<u.length;y++)g+=m[u[y]];l=parseFloat(g)}i<=21&&(d=["version","Notice","FullName","FamilyName","Weight","FontBBox","BlueValues","OtherBlues","FamilyBlues","FamilyOtherBlues","StdHW","StdVW","escape","UniqueID","XUID","charset","Encoding","CharStrings","Private","Subrs","defaultWidthX","nominalWidthX"][i],f=1,12==i&&(d=["Copyright","isFixedPitch","ItalicAngle","UnderlinePosition","UnderlineThickness","PaintType","CharstringType","FontMatrix","StrokeWidth","BlueScale","BlueShift","BlueFuzz","StemSnapH","StemSnapV","ForceBold","","","LanguageGroup","ExpansionFactor","initialRandomSeed","SyntheticBase","PostScript","BaseFontName","BaseFontBlend","","","","","","","ROS","CIDFontVersion","CIDFontRevision","CIDFontType","CIDCount","UIDBase","FDArray","FDSelect","FontName"][h],f=2)),null!=d?(s[d]=1==o.length?o[0]:o,o=[]):o.push(l),e+=f}return s}},n.T.cmap={parseTab:function(r,e,t){var a={tables:[],ids:{},off:e};r=new Uint8Array(r.buffer,e,t),e=0;var s=n.B,o=s.readUshort,i=n.T.cmap,h=(o(r,e),o(r,e+=2));e+=2;for(var f=[],d=0;d<h;d++){var l=o(r,e),u=o(r,e+=2);e+=2;var c=s.readUint(r,e);e+=4;var v="p"+l+"e"+u,p=f.indexOf(c);if(-1==p){p=a.tables.length;var g={};f.push(c);var m=g.format=o(r,c);0==m?g=i.parse0(r,c,g):4==m?g=i.parse4(r,c,g):6==m?g=i.parse6(r,c,g):12==m&&(g=i.parse12(r,c,g)),a.tables.push(g)}if(null!=a.ids[v])throw"multiple tables for one platform+encoding";a.ids[v]=p}return a},parse0:function(r,e,t){var a=n.B;e+=2;var s=a.readUshort(r,e);e+=2,a.readUshort(r,e),e+=2,t.map=[];for(var o=0;o<s-6;o++)t.map.push(r[e+o]);return t},parse4:function(r,e,t){var a=n.B,s=a.readUshort,o=a.readUshorts,i=e,h=s(r,e+=2),f=(s(r,e+=2),s(r,e+=2));e+=2;var d=f>>>1;t.searchRange=s(r,e),e+=2,t.entrySelector=s(r,e),e+=2,t.rangeShift=s(r,e),e+=2,t.endCount=o(r,e,d),e+=2*d,e+=2,t.startCount=o(r,e,d),e+=2*d,t.idDelta=[];for(var l=0;l<d;l++)t.idDelta.push(a.readShort(r,e)),e+=2;return t.idRangeOffset=o(r,e,d),e+=2*d,t.glyphIdArray=o(r,e,i+h-e>>>1),t},parse6:function(r,e,t){var a=n.B;e+=2,a.readUshort(r,e),e+=2,a.readUshort(r,e),e+=2,t.firstCode=a.readUshort(r,e),e+=2;var s=a.readUshort(r,e);e+=2,t.glyphIdArray=[];for(var o=0;o<s;o++)t.glyphIdArray.push(a.readUshort(r,e)),e+=2;return t},parse12:function(r,e,t){var a=n.B.readUint,s=(a(r,e+=4),a(r,e+=4),3*a(r,e+=4));e+=4;for(var o=t.groups=new Uint32Array(s),i=0;i<s;i+=3)o[i]=a(r,e+(i<<2)),o[i+1]=a(r,e+(i<<2)+4),o[i+2]=a(r,e+(i<<2)+8);return t}},n.T.glyf={parseTab:function(r,e,t,a){for(var n=[],s=a.maxp.numGlyphs,o=0;o<s;o++)n.push(null);return n},_parseGlyf:function(r,e){var t=n.B,a=r._data,s=r.loca;if(s[e]==s[e+1])return null;var o=n.findTable(a,"glyf",r._offset)[0]+s[e],i={};if(i.noc=t.readShort(a,o),o+=2,i.xMin=t.readShort(a,o),o+=2,i.yMin=t.readShort(a,o),o+=2,i.xMax=t.readShort(a,o),o+=2,i.yMax=t.readShort(a,o),o+=2,i.xMin>=i.xMax||i.yMin>=i.yMax)return null;if(i.noc>0){i.endPts=[];for(var h=0;h<i.noc;h++)i.endPts.push(t.readUshort(a,o)),o+=2;var f=t.readUshort(a,o);if(o+=2,a.length-o<f)return null;i.instructions=t.readBytes(a,o,f),o+=f;var d=i.endPts[i.noc-1]+1;for(i.flags=[],h=0;h<d;h++){var l=a[o];if(o++,i.flags.push(l),0!=(8&l)){var u=a[o];o++;for(var c=0;c<u;c++)i.flags.push(l),h++}}for(i.xs=[],h=0;h<d;h++){var v=0!=(2&i.flags[h]),p=0!=(16&i.flags[h]);v?(i.xs.push(p?a[o]:-a[o]),o++):p?i.xs.push(0):(i.xs.push(t.readShort(a,o)),o+=2)}for(i.ys=[],h=0;h<d;h++)v=0!=(4&i.flags[h]),p=0!=(32&i.flags[h]),v?(i.ys.push(p?a[o]:-a[o]),o++):p?i.ys.push(0):(i.ys.push(t.readShort(a,o)),o+=2);var g=0,m=0;for(h=0;h<d;h++)g+=i.xs[h],m+=i.ys[h],i.xs[h]=g,i.ys[h]=m}else{var y;i.parts=[];do{y=t.readUshort(a,o),o+=2;var S={m:{a:1,b:0,c:0,d:1,tx:0,ty:0},p1:-1,p2:-1};if(i.parts.push(S),S.glyphIndex=t.readUshort(a,o),o+=2,1&y){var U=t.readShort(a,o);o+=2;var T=t.readShort(a,o);o+=2}else U=t.readInt8(a,o),o++,T=t.readInt8(a,o),o++;2&y?(S.m.tx=U,S.m.ty=T):(S.p1=U,S.p2=T),8&y?(S.m.a=S.m.d=t.readF2dot14(a,o),o+=2):64&y?(S.m.a=t.readF2dot14(a,o),o+=2,S.m.d=t.readF2dot14(a,o),o+=2):128&y&&(S.m.a=t.readF2dot14(a,o),o+=2,S.m.b=t.readF2dot14(a,o),o+=2,S.m.c=t.readF2dot14(a,o),o+=2,S.m.d=t.readF2dot14(a,o),o+=2)}while(32&y);if(256&y){var C=t.readUshort(a,o);for(o+=2,i.instr=[],h=0;h<C;h++)i.instr.push(a[o]),o++}}return i}},n.T.head={parseTab:function(r,e,t){var a=n.B,s={};return a.readFixed(r,e),e+=4,s.fontRevision=a.readFixed(r,e),e+=4,a.readUint(r,e),e+=4,a.readUint(r,e),e+=4,s.flags=a.readUshort(r,e),e+=2,s.unitsPerEm=a.readUshort(r,e),e+=2,s.created=a.readUint64(r,e),e+=8,s.modified=a.readUint64(r,e),e+=8,s.xMin=a.readShort(r,e),e+=2,s.yMin=a.readShort(r,e),e+=2,s.xMax=a.readShort(r,e),e+=2,s.yMax=a.readShort(r,e),e+=2,s.macStyle=a.readUshort(r,e),e+=2,s.lowestRecPPEM=a.readUshort(r,e),e+=2,s.fontDirectionHint=a.readShort(r,e),e+=2,s.indexToLocFormat=a.readShort(r,e),e+=2,s.glyphDataFormat=a.readShort(r,e),e+=2,s}},n.T.hhea={parseTab:function(r,e,t){var a=n.B,s={};a.readFixed(r,e),e+=4;for(var o=["ascender","descender","lineGap","advanceWidthMax","minLeftSideBearing","minRightSideBearing","xMaxExtent","caretSlopeRise","caretSlopeRun","caretOffset","res0","res1","res2","res3","metricDataFormat","numberOfHMetrics"],i=0;i<o.length;i++){var h=o[i],f="advanceWidthMax"==h||"numberOfHMetrics"==h?a.readUshort:a.readShort;s[h]=f(r,e+2*i)}return s}},n.T.hmtx={parseTab:function(r,e,t,a){for(var s=n.B,o=[],i=[],h=a.maxp.numGlyphs,f=a.hhea.numberOfHMetrics,d=0,l=0,u=0;u<f;)d=s.readUshort(r,e+(u<<2)),l=s.readShort(r,e+(u<<2)+2),o.push(d),i.push(l),u++;for(;u<h;)o.push(d),i.push(l),u++;return{aWidth:o,lsBearing:i}}},n.T.kern={parseTab:function(r,e,t,a){var s=n.B,o=n.T.kern;if(1==s.readUshort(r,e))return o.parseV1(r,e,t,a);var i=s.readUshort(r,e+2);e+=4;for(var h={glyph1:[],rval:[]},f=0;f<i;f++){e+=2,t=s.readUshort(r,e),e+=2;var d=s.readUshort(r,e);e+=2;var l=d>>>8;0==(l&=15)&&(e=o.readFormat0(r,e,h))}return h},parseV1:function(r,e,t,a){var s=n.B,o=n.T.kern,i=(s.readFixed(r,e),s.readUint(r,e+4));e+=8;for(var h={glyph1:[],rval:[]},f=0;f<i;f++){s.readUint(r,e),e+=4;var d=s.readUshort(r,e);e+=2,s.readUshort(r,e),e+=2,0==(255&d)&&(e=o.readFormat0(r,e,h))}return h},readFormat0:function(r,e,t){var a=n.B,s=a.readUshort,o=-1,i=s(r,e);s(r,e+2),s(r,e+4),s(r,e+6),e+=8;for(var h=0;h<i;h++){var f=s(r,e),d=s(r,e+=2);e+=2;var l=a.readShort(r,e);e+=2,f!=o&&(t.glyph1.push(f),t.rval.push({glyph2:[],vals:[]}));var u=t.rval[t.rval.length-1];u.glyph2.push(d),u.vals.push(l),o=f}return e}},n.T.loca={parseTab:function(r,e,t,a){var s=n.B,o=[],i=a.head.indexToLocFormat,h=a.maxp.numGlyphs+1;if(0==i)for(var f=0;f<h;f++)o.push(s.readUshort(r,e+(f<<1))<<1);if(1==i)for(f=0;f<h;f++)o.push(s.readUint(r,e+(f<<2)));return o}},n.T.maxp={parseTab:function(r,e,t){var a=n.B,s=a.readUshort,o={};return a.readUint(r,e),e+=4,o.numGlyphs=s(r,e),e+=2,o}},n.T.name={parseTab:function(r,e,t){var a=n.B,s={};a.readUshort(r,e),e+=2;var o=a.readUshort(r,e);e+=2,a.readUshort(r,e);for(var i=["copyright","fontFamily","fontSubfamily","ID","fullName","version","postScriptName","trademark","manufacturer","designer","description","urlVendor","urlDesigner","licence","licenceURL","---","typoFamilyName","typoSubfamilyName","compatibleFull","sampleText","postScriptCID","wwsFamilyName","wwsSubfamilyName","lightPalette","darkPalette"],h=e+=2,f=a.readUshort,d=0;d<o;d++){var l=f(r,e),u=f(r,e+=2),c=f(r,e+=2),v=f(r,e+=2),p=f(r,e+=2),g=f(r,e+=2);e+=2;var m,y=h+12*o+g;0==l||3==l&&0==u?m=a.readUnicode(r,y,p/2):0==u?m=a.readASCII(r,y,p):1==u||3==u||4==u||10==u?m=a.readUnicode(r,y,p/2):1==l?(m=a.readASCII(r,y,p),console.log("reading unknown MAC encoding "+u+" as ASCII")):(console.log("unknown encoding "+u+", platformID: "+l),m=a.readASCII(r,y,p));var S="p"+l+","+c.toString(16);null==s[S]&&(s[S]={}),s[S][i[v]]=m,s[S]._lang=c}var U,T="postScriptName";for(var C in s)if(null!=s[C][T]&&1033==s[C]._lang)return s[C];for(var C in s)if(null!=s[C][T]&&0==s[C]._lang)return s[C];for(var C in s)if(null!=s[C][T]&&3084==s[C]._lang)return s[C];for(var C in s)if(null!=s[C][T])return s[C];for(var C in s){U=s[C];break}return console.log("returning name table with languageID "+U._lang),null==U[T]&&null!=U.ID&&(U[T]=U.ID),U}},n.T.OS2={parseTab:function(r,e,t){var a=n.B.readUshort(r,e);e+=2;var s=n.T.OS2,o={};if(0==a)s.version0(r,e,o);else if(1==a)s.version1(r,e,o);else if(2==a||3==a||4==a)s.version2(r,e,o);else{if(5!=a)throw"unknown OS/2 table version: "+a;s.version5(r,e,o)}return o},version0:function(r,e,t){var a=n.B;return t.xAvgCharWidth=a.readShort(r,e),e+=2,t.usWeightClass=a.readUshort(r,e),e+=2,t.usWidthClass=a.readUshort(r,e),e+=2,t.fsType=a.readUshort(r,e),e+=2,t.ySubscriptXSize=a.readShort(r,e),e+=2,t.ySubscriptYSize=a.readShort(r,e),e+=2,t.ySubscriptXOffset=a.readShort(r,e),e+=2,t.ySubscriptYOffset=a.readShort(r,e),e+=2,t.ySuperscriptXSize=a.readShort(r,e),e+=2,t.ySuperscriptYSize=a.readShort(r,e),e+=2,t.ySuperscriptXOffset=a.readShort(r,e),e+=2,t.ySuperscriptYOffset=a.readShort(r,e),e+=2,t.yStrikeoutSize=a.readShort(r,e),e+=2,t.yStrikeoutPosition=a.readShort(r,e),e+=2,t.sFamilyClass=a.readShort(r,e),e+=2,t.panose=a.readBytes(r,e,10),e+=10,t.ulUnicodeRange1=a.readUint(r,e),e+=4,t.ulUnicodeRange2=a.readUint(r,e),e+=4,t.ulUnicodeRange3=a.readUint(r,e),e+=4,t.ulUnicodeRange4=a.readUint(r,e),e+=4,t.achVendID=a.readASCII(r,e,4),e+=4,t.fsSelection=a.readUshort(r,e),e+=2,t.usFirstCharIndex=a.readUshort(r,e),e+=2,t.usLastCharIndex=a.readUshort(r,e),e+=2,t.sTypoAscender=a.readShort(r,e),e+=2,t.sTypoDescender=a.readShort(r,e),e+=2,t.sTypoLineGap=a.readShort(r,e),e+=2,t.usWinAscent=a.readUshort(r,e),e+=2,t.usWinDescent=a.readUshort(r,e),e+2},version1:function(r,e,t){var a=n.B;return e=n.T.OS2.version0(r,e,t),t.ulCodePageRange1=a.readUint(r,e),e+=4,t.ulCodePageRange2=a.readUint(r,e),e+4},version2:function(r,e,t){var a=n.B,s=a.readUshort;return e=n.T.OS2.version1(r,e,t),t.sxHeight=a.readShort(r,e),e+=2,t.sCapHeight=a.readShort(r,e),e+=2,t.usDefault=s(r,e),e+=2,t.usBreak=s(r,e),e+=2,t.usMaxContext=s(r,e),e+2},version5:function(r,e,t){var a=n.B.readUshort;return e=n.T.OS2.version2(r,e,t),t.usLowerOpticalPointSize=a(r,e),e+=2,t.usUpperOpticalPointSize=a(r,e),e+2}},n.T.post={parseTab:function(r,e,t){var a=n.B,s={};return s.version=a.readFixed(r,e),e+=4,s.italicAngle=a.readFixed(r,e),e+=4,s.underlinePosition=a.readShort(r,e),e+=2,s.underlineThickness=a.readShort(r,e),e+=2,s}},n.T.SVG={parseTab:function(r,e,t){var a=n.B,s={entries:[]},o=e;a.readUshort(r,e),e+=2;var i=a.readUint(r,e);e+=4,a.readUint(r,e),e+=4,e=i+o;var h=a.readUshort(r,e);e+=2;for(var f=0;f<h;f++){var d=a.readUshort(r,e);e+=2;var l=a.readUshort(r,e);e+=2;var u=a.readUint(r,e);e+=4;var c=a.readUint(r,e);e+=4;for(var v=new Uint8Array(r.buffer,o+u+i,c),p=a.readUTF8(v,0,v.length),g=d;g<=l;g++)s.entries[g]=p}return s}},n.U={shape:function(r,e,t){for(var a=function(r,e,t,a){var n=e[t],s=e[t+1],o=r.kern;if(o){var i=o.glyph1.indexOf(n);if(-1!=i){var h=o.rval[i].glyph2.indexOf(s);if(-1!=h)return[0,0,o.rval[i].vals[h],0]}}return[0,0,0,0]},s=[],o=0;o<e.length;o++){var i=e.codePointAt(o);i>65535&&o++,s.push(n.U.codeToGlyph(r,i))}var h=[];for(o=0;o<s.length;o++){var f=a(r,s,o),d=s[o],l=r.hmtx.aWidth[d]+f[2];h.push({g:d,cl:o,dx:0,dy:0,ax:l,ay:0})}return h},shapeToPath:function(r,e,t){for(var a={cmds:[],crds:[]},s=0,o=0,i=0;i<e.length;i++){for(var h=e[i],f=n.U.glyphToPath(r,h.g),d=f.crds,l=0;l<d.length;l+=2)a.crds.push(d[l]+s+h.dx),a.crds.push(d[l+1]+o+h.dy);for(t&&a.cmds.push(t),l=0;l<f.cmds.length;l++)a.cmds.push(f.cmds[l]);var u=a.cmds.length;t&&0!=u&&"X"!=a.cmds[u-1]&&a.cmds.push("X"),s+=h.ax,o+=h.ay}return{cmds:a.cmds,crds:a.crds}},codeToGlyph:function(r,e){for(var t=r.cmap,a=-1,n=["p3e10","p0e4","p3e1","p1e0","p0e3","p0e1"],s=0;s<n.length;s++)if(null!=t.ids[n[s]]){a=t.ids[n[s]];break}if(-1==a)throw"no familiar platform and encoding!";var o=function(r,e,t){for(var a=0,n=Math.floor(r.length/e);a+1!=n;){var s=a+(n-a>>>1);r[s*e]<=t?a=s:n=s}return a*e},i=t.tables[a],h=i.format,f=-1;if(0==h)f=e>=i.map.length?0:i.map[e];else if(4==h){var d=-1,l=i.endCount;e>l[l.length-1]?d=-1:l[d=o(l,1,e)]<e&&d++,f=-1==d||e<i.startCount[d]?0:65535&(0!=i.idRangeOffset[d]?i.glyphIdArray[e-i.startCount[d]+(i.idRangeOffset[d]>>1)-(i.idRangeOffset.length-d)]:e+i.idDelta[d])}else if(6==h){var u=e-i.firstCode,c=i.glyphIdArray;f=u<0||u>=c.length?0:c[u]}else{if(12!=h)throw"unknown cmap table format "+i.format;var v=i.groups;e>v[v.length-2]?f=0:(v[s=o(v,3,e)]<=e&&e<=v[s+1]&&(f=v[s+2]+(e-v[s])),-1==f&&(f=0))}var p=r["SVG "],g=r.loca;return 0==f||null!=r["CFF "]||null!=p&&null!=p.entries[f]||g[f]!=g[f+1]||-1!=[9,10,11,12,13,32,133,160,5760,8232,8233,8239,12288,6158,8203,8204,8205,8288,65279].indexOf(e)||8192<=e&&e<=8202||(f=0),f},glyphToPath:function(r,e){var t={cmds:[],crds:[]},a=r["SVG "],s=r["CFF "],o=n.U;if(a&&a.entries[e]){var i=a.entries[e];null!=i&&("string"==typeof i&&(i=o.SVG.toPath(i),a.entries[e]=i),t=i)}else if(s){var h=s.Private,f={x:0,y:0,stack:[],nStems:0,haveWidth:!1,width:h?h.defaultWidthX:0,open:!1};if(s.ROS){for(var d=0;s.FDSelect[d+2]<=e;)d+=2;h=s.FDArray[s.FDSelect[d+1]].Private}o._drawCFF(s.CharStrings[e],f,s,h,t)}else r.glyf&&o._drawGlyf(e,r,t);return{cmds:t.cmds,crds:t.crds}},_drawGlyf:function(r,e,t){var a=e.glyf[r];null==a&&(a=e.glyf[r]=n.T.glyf._parseGlyf(e,r)),null!=a&&(a.noc>-1?n.U._simpleGlyph(a,t):n.U._compoGlyph(a,e,t))},_simpleGlyph:function(r,e){for(var t=n.U.P,a=0;a<r.noc;a++){for(var s=0==a?0:r.endPts[a-1]+1,o=r.endPts[a],i=s;i<=o;i++){var h=i==s?o:i-1,f=i==o?s:i+1,d=1&r.flags[i],l=1&r.flags[h],u=1&r.flags[f],c=r.xs[i],v=r.ys[i];if(i==s)if(d){if(!l){t.MoveTo(e,c,v);continue}t.MoveTo(e,r.xs[h],r.ys[h])}else l?t.MoveTo(e,r.xs[h],r.ys[h]):t.MoveTo(e,Math.floor(.5*(r.xs[h]+c)),Math.floor(.5*(r.ys[h]+v)));d?l&&t.LineTo(e,c,v):u?t.qCurveTo(e,c,v,r.xs[f],r.ys[f]):t.qCurveTo(e,c,v,Math.floor(.5*(c+r.xs[f])),Math.floor(.5*(v+r.ys[f])))}t.ClosePath(e)}},_compoGlyph:function(r,e,t){for(var a=0;a<r.parts.length;a++){var s={cmds:[],crds:[]},o=r.parts[a];n.U._drawGlyf(o.glyphIndex,e,s);for(var i=o.m,h=0;h<s.crds.length;h+=2){var f=s.crds[h],d=s.crds[h+1];t.crds.push(f*i.a+d*i.b+i.tx),t.crds.push(f*i.c+d*i.d+i.ty)}for(h=0;h<s.cmds.length;h++)t.cmds.push(s.cmds[h])}},pathToSVG:function(r,e){var t=r.cmds,a=r.crds;null==e&&(e=5);for(var n=[],s=0,o={M:2,L:2,Q:4,C:6},i=0;i<t.length;i++){var h=t[i],f=s+(o[h]?o[h]:0);for(n.push(h);s<f;){var d=a[s++];n.push(parseFloat(d.toFixed(e))+(s==f?"":" "))}}return n.join("")},SVGToPath:function(r){var e={cmds:[],crds:[]};return n.U.SVG.svgToPath(r,e),{cmds:e.cmds,crds:e.crds}},pathToContext:function(r,e){for(var t=0,a=r.cmds,n=r.crds,s=0;s<a.length;s++){var o=a[s];"M"==o?(e.moveTo(n[t],n[t+1]),t+=2):"L"==o?(e.lineTo(n[t],n[t+1]),t+=2):"C"==o?(e.bezierCurveTo(n[t],n[t+1],n[t+2],n[t+3],n[t+4],n[t+5]),t+=6):"Q"==o?(e.quadraticCurveTo(n[t],n[t+1],n[t+2],n[t+3]),t+=4):"#"==o.charAt(0)?(e.beginPath(),e.fillStyle=o):"Z"==o?e.closePath():"X"==o&&e.fill()}},P:{MoveTo:function(r,e,t){r.cmds.push("M"),r.crds.push(e,t)},LineTo:function(r,e,t){r.cmds.push("L"),r.crds.push(e,t)},CurveTo:function(r,e,t,a,n,s,o){r.cmds.push("C"),r.crds.push(e,t,a,n,s,o)},qCurveTo:function(r,e,t,a,n){r.cmds.push("Q"),r.crds.push(e,t,a,n)},ClosePath:function(r){r.cmds.push("Z")}},_drawCFF:function(r,e,t,a,s){for(var o=e.stack,i=e.nStems,h=e.haveWidth,f=e.width,d=e.open,l=0,u=e.x,c=e.y,v=0,p=0,g=0,m=0,y=0,S=0,U=0,T=0,C=0,b=0,x=n.T.CFF,F=n.U.P,w=a.nominalWidthX,B={val:0,size:0};l<r.length;){x.getCharString(r,l,B);var M=B.val;if(l+=B.size,"o1"==M||"o18"==M)o.length%2!=0&&!h&&(f=o.shift()+w),i+=o.length>>1,o.length=0,h=!0;else if("o3"==M||"o23"==M)o.length%2!=0&&!h&&(f=o.shift()+w),i+=o.length>>1,o.length=0,h=!0;else if("o4"==M)o.length>1&&!h&&(f=o.shift()+w,h=!0),d&&F.ClosePath(s),c+=o.pop(),F.MoveTo(s,u,c),d=!0;else if("o5"==M)for(;o.length>0;)u+=o.shift(),c+=o.shift(),F.LineTo(s,u,c);else if("o6"==M||"o7"==M)for(var I=o.length,_="o6"==M,A=0;A<I;A++){var P=o.shift();_?u+=P:c+=P,_=!_,F.LineTo(s,u,c)}else if("o8"==M||"o24"==M){I=o.length;for(var D=0;D+6<=I;)v=u+o.shift(),p=c+o.shift(),g=v+o.shift(),m=p+o.shift(),u=g+o.shift(),c=m+o.shift(),F.CurveTo(s,v,p,g,m,u,c),D+=6;"o24"==M&&(u+=o.shift(),c+=o.shift(),F.LineTo(s,u,c))}else{if("o11"==M)break;if("o1234"==M||"o1235"==M||"o1236"==M||"o1237"==M)"o1234"==M&&(p=c,g=(v=u+o.shift())+o.shift(),b=m=p+o.shift(),S=m,T=c,u=(U=(y=(C=g+o.shift())+o.shift())+o.shift())+o.shift(),F.CurveTo(s,v,p,g,m,C,b),F.CurveTo(s,y,S,U,T,u,c)),"o1235"==M&&(v=u+o.shift(),p=c+o.shift(),g=v+o.shift(),m=p+o.shift(),C=g+o.shift(),b=m+o.shift(),y=C+o.shift(),S=b+o.shift(),U=y+o.shift(),T=S+o.shift(),u=U+o.shift(),c=T+o.shift(),o.shift(),F.CurveTo(s,v,p,g,m,C,b),F.CurveTo(s,y,S,U,T,u,c)),"o1236"==M&&(v=u+o.shift(),p=c+o.shift(),g=v+o.shift(),b=m=p+o.shift(),S=m,U=(y=(C=g+o.shift())+o.shift())+o.shift(),T=S+o.shift(),u=U+o.shift(),F.CurveTo(s,v,p,g,m,C,b),F.CurveTo(s,y,S,U,T,u,c)),"o1237"==M&&(v=u+o.shift(),p=c+o.shift(),g=v+o.shift(),m=p+o.shift(),C=g+o.shift(),b=m+o.shift(),y=C+o.shift(),S=b+o.shift(),U=y+o.shift(),T=S+o.shift(),Math.abs(U-u)>Math.abs(T-c)?u=U+o.shift():c=T+o.shift(),F.CurveTo(s,v,p,g,m,C,b),F.CurveTo(s,y,S,U,T,u,c));else if("o14"==M){if(o.length>0&&!h&&(f=o.shift()+t.nominalWidthX,h=!0),4==o.length){var O=o.shift(),k=o.shift(),G=o.shift(),L=o.shift(),W=x.glyphBySE(t,G),R=x.glyphBySE(t,L);n.U._drawCFF(t.CharStrings[W],e,t,a,s),e.x=O,e.y=k,n.U._drawCFF(t.CharStrings[R],e,t,a,s)}d&&(F.ClosePath(s),d=!1)}else if("o19"==M||"o20"==M)o.length%2!=0&&!h&&(f=o.shift()+w),i+=o.length>>1,o.length=0,h=!0,l+=i+7>>3;else if("o21"==M)o.length>2&&!h&&(f=o.shift()+w,h=!0),c+=o.pop(),u+=o.pop(),d&&F.ClosePath(s),F.MoveTo(s,u,c),d=!0;else if("o22"==M)o.length>1&&!h&&(f=o.shift()+w,h=!0),u+=o.pop(),d&&F.ClosePath(s),F.MoveTo(s,u,c),d=!0;else if("o25"==M){for(;o.length>6;)u+=o.shift(),c+=o.shift(),F.LineTo(s,u,c);v=u+o.shift(),p=c+o.shift(),g=v+o.shift(),m=p+o.shift(),u=g+o.shift(),c=m+o.shift(),F.CurveTo(s,v,p,g,m,u,c)}else if("o26"==M)for(o.length%2&&(u+=o.shift());o.length>0;)v=u,p=c+o.shift(),u=g=v+o.shift(),c=(m=p+o.shift())+o.shift(),F.CurveTo(s,v,p,g,m,u,c);else if("o27"==M)for(o.length%2&&(c+=o.shift());o.length>0;)p=c,g=(v=u+o.shift())+o.shift(),m=p+o.shift(),u=g+o.shift(),c=m,F.CurveTo(s,v,p,g,m,u,c);else if("o10"==M||"o29"==M){var V="o10"==M?a:t;if(0==o.length)console.log("error: empty stack");else{var N=o.pop(),E=V.Subrs[N+V.Bias];e.x=u,e.y=c,e.nStems=i,e.haveWidth=h,e.width=f,e.open=d,n.U._drawCFF(E,e,t,a,s),u=e.x,c=e.y,i=e.nStems,h=e.haveWidth,f=e.width,d=e.open}}else if("o30"==M||"o31"==M){var z=o.length,X=(D=0,"o31"==M);for(D+=z-(I=-3&z);D<I;)X?(p=c,g=(v=u+o.shift())+o.shift(),c=(m=p+o.shift())+o.shift(),I-D==5?(u=g+o.shift(),D++):u=g,X=!1):(v=u,p=c+o.shift(),g=v+o.shift(),m=p+o.shift(),u=g+o.shift(),I-D==5?(c=m+o.shift(),D++):c=m,X=!0),F.CurveTo(s,v,p,g,m,u,c),D+=4}else{if("o"==(M+"").charAt(0))throw console.log("Unknown operation: "+M,r),M;o.push(M)}}}e.x=u,e.y=c,e.nStems=i,e.haveWidth=h,e.width=f,e.open=d},SVG:function(){var r={getScale:function(r){return Math.sqrt(Math.abs(r[0]*r[3]-r[1]*r[2]))},translate:function(e,t,a){r.concat(e,[1,0,0,1,t,a])},rotate:function(e,t){r.concat(e,[Math.cos(t),-Math.sin(t),Math.sin(t),Math.cos(t),0,0])},scale:function(e,t,a){r.concat(e,[t,0,0,a,0,0])},concat:function(r,e){var t=r[0],a=r[1],n=r[2],s=r[3],o=r[4],i=r[5];r[0]=t*e[0]+a*e[2],r[1]=t*e[1]+a*e[3],r[2]=n*e[0]+s*e[2],r[3]=n*e[1]+s*e[3],r[4]=o*e[0]+i*e[2]+e[4],r[5]=o*e[1]+i*e[3]+e[5]},invert:function(r){var e=r[0],t=r[1],a=r[2],n=r[3],s=r[4],o=r[5],i=e*n-t*a;r[0]=n/i,r[1]=-t/i,r[2]=-a/i,r[3]=e/i,r[4]=(a*o-n*s)/i,r[5]=(t*s-e*o)/i},multPoint:function(r,e){var t=e[0],a=e[1];return[t*r[0]+a*r[2]+r[4],t*r[1]+a*r[3]+r[5]]},multArray:function(r,e){for(var t=0;t<e.length;t+=2){var a=e[t],n=e[t+1];e[t]=a*r[0]+n*r[2]+r[4],e[t+1]=a*r[1]+n*r[3]+r[5]}}};function e(r,e,t){for(var a=[],n=0,s=0,o=0;;){var i=r.indexOf(e,s),h=r.indexOf(t,s);if(-1==i&&-1==h)break;-1==h||-1!=i&&i<h?(0==o&&(a.push(r.slice(n,i).trim()),n=i+1),o++,s=i+1):(-1==i||-1!=h&&h<i)&&(0==--o&&(a.push(r.slice(n,h).trim()),n=h+1),s=h+1)}return a}function t(t){for(var n=e(t,"(",")"),s=[1,0,0,1,0,0],o=0;o<n.length;o+=2){var i=s;s=a(n[o],n[o+1]),r.concat(s,i)}return s}function a(e,t){for(var a=[1,0,0,1,0,0],n=!0,s=0;s<t.length;s++){var o=t.charAt(s);","==o||" "==o?n=!0:"."==o?(n||(t=t.slice(0,s)+","+t.slice(s),s++),n=!1):"-"==o&&s>0&&"e"!=t[s-1]&&(t=t.slice(0,s)+" "+t.slice(s),s++,n=!0)}if(t=t.split(/\s*[\s,]\s*/).map(parseFloat),"translate"==e)1==t.length?r.translate(a,t[0],0):r.translate(a,t[0],t[1]);else if("scale"==e)1==t.length?r.scale(a,t[0],t[0]):r.scale(a,t[0],t[1]);else if("rotate"==e){var i=0,h=0;1!=t.length&&(i=t[1],h=t[2]),r.translate(a,-i,-h),r.rotate(a,-Math.PI*t[0]/180),r.translate(a,i,h)}else"matrix"==e?a=t:console.log("unknown transform: ",e);return a}function n(r,e,t){for(var a=e;a<r.length&&"string"!=typeof r[a];)a+=t;return(a-e)/t}function s(r,e){for(var t=function(r){for(var e=[],t=0,a=!1,n="",s="";t<r.length;){var o=r.charCodeAt(t),i=r.charAt(t);t++;var h=48<=o&&o<=57||"."==i||"-"==i||"e"==i||"E"==i;a?"-"==i&&"e"!=s||"."==i&&-1!=n.indexOf(".")?(e.push(parseFloat(n)),n=i):h?n+=i:(e.push(parseFloat(n)),","!=i&&" "!=i&&e.push(i),a=!1):h?(n=i,a=!0):","!=i&&" "!=i&&e.push(i),s=i}return a&&e.push(parseFloat(n)),e}(r),a=0,s=0,o=0,i=0,h=0,f=e.crds.length,d={M:2,L:2,H:1,V:1,T:2,S:4,A:7,Q:4,C:6},l=e.cmds,u=e.crds;a<t.length;){var c=t[a];a++;var v=c.toUpperCase();if("Z"==v)l.push("Z"),s=i,o=h;else for(var p=n(t,a,d[v]),g=0;g<p;g++){1==g&&"M"==v&&(c=c==v?"L":"l",v="L");var m=0,y=0;if(c!=v&&(m=s,y=o),"M"==v)s=m+t[a++],o=y+t[a++],l.push("M"),u.push(s,o),i=s,h=o;else if("L"==v)s=m+t[a++],o=y+t[a++],l.push("L"),u.push(s,o);else if("H"==v)s=m+t[a++],l.push("L"),u.push(s,o);else if("V"==v)o=y+t[a++],l.push("L"),u.push(s,o);else if("Q"==v){var S=m+t[a++],U=y+t[a++],T=m+t[a++],C=y+t[a++];l.push("Q"),u.push(S,U,T,C),s=T,o=C}else if("T"==v)S=s+s-u[F=Math.max(u.length-2,f)],U=o+o-u[F+1],T=m+t[a++],C=y+t[a++],l.push("Q"),u.push(S,U,T,C),s=T,o=C;else if("C"==v){S=m+t[a++],U=y+t[a++],T=m+t[a++],C=y+t[a++];var b=m+t[a++],x=y+t[a++];l.push("C"),u.push(S,U,T,C,b,x),s=b,o=x}else if("S"==v){var F;S=s+s-u[F=Math.max(u.length-("C"==l[l.length-1]?4:2),f)],U=o+o-u[F+1],T=m+t[a++],C=y+t[a++],b=m+t[a++],x=y+t[a++],l.push("C"),u.push(S,U,T,C,b,x),s=b,o=x}else if("A"==v){S=s,U=o;var w=t[a++],B=t[a++],M=t[a++]*(Math.PI/180),I=t[a++],_=t[a++];if(T=m+t[a++],C=y+t[a++],T==s&&C==o&&0==w&&0==B)continue;var A=(S-T)/2,P=(U-C)/2,D=Math.cos(M),O=Math.sin(M),k=D*A+O*P,G=-O*A+D*P,L=w*w,W=B*B,R=k*k,V=G*G,N=(L*W-L*V-W*R)/(L*V+W*R),E=(I!=_?1:-1)*Math.sqrt(Math.max(N,0)),z=E*(w*G)/B,X=B*k*-E/w,H=D*z-O*X+(S+T)/2,q=O*z+D*X+(U+C)/2,Q=function(r,e,t,a){var n=(r*t+e*a)/(Math.sqrt(r*r+e*e)*Math.sqrt(t*t+a*a));return(r*a-e*t>=0?1:-1)*Math.acos(Math.max(-1,Math.min(1,n)))},j=(k-z)/w,Y=(G-X)/B,Z=Q(1,0,j,Y),J=Q(j,Y,(-k-z)/w,(-G-X)/B);!function(r,e,t,a,n,s,o){var i=function(r,e){var t=Math.sin(e),a=Math.cos(e),n=(e=r[0],r[1]),s=r[2],o=r[3];r[0]=e*a+n*t,r[1]=-e*t+n*a,r[2]=s*a+o*t,r[3]=-s*t+o*a},h=function(r,e){for(var t=0;t<e.length;t+=2){var a=e[t],n=e[t+1];e[t]=r[0]*a+r[2]*n+r[4],e[t+1]=r[1]*a+r[3]*n+r[5]}},f=function(r,e){for(var t=0;t<e.length;t++)r.push(e[t])};if(o)for(;s>n;)s-=2*Math.PI;else for(;s<n;)s+=2*Math.PI;var d=(s-n)/4,l=Math.cos(d/2),u=-Math.sin(d/2),c=(4-l)/3,v=0==u?u:(1-l)*(3-l)/(3*u),p=[c,v,c,-v,l,-u],g={cmds:["C","C","C","C"],crds:p.slice(0)},m=[1,0,0,1,0,0];i(m,-d);for(var y=0;y<3;y++)h(m,p),f(g.crds,p);i(m,d/2-n),m[0]*=1,m[1]*=1,m[2]*=1,m[3]*=1,m[4]=0,m[5]=0,h(m,g.crds),h(r.ctm,g.crds),function(r,e){f(r.cmds,e.cmds),f(r.crds,e.crds)}(r.pth,g)}({pth:e,ctm:[w*D,w*O,-B*O,B*D,H,q]},0,0,0,Z,Z+(J%=2*Math.PI),0==_),s=T,o=C}else console.log("Unknown SVG command "+c)}}}return{cssMap:function(r){for(var t=e(r,"{","}"),a={},n=0;n<t.length;n+=2)for(var s=t[n].split(","),o=0;o<s.length;o++){var i=s[o].trim();null==a[i]&&(a[i]=""),a[i]+=t[n+1]}return a},readTrnf:t,svgToPath:s,toPath:function(e){var a={cmds:[],crds:[]};if(null==e)return a;var n=(new DOMParser).parseFromString(e,"image/svg+xml").getElementsByTagName("svg")[0],o=n.getAttribute("viewBox");o=o?o.trim().split(" ").map(parseFloat):[0,0,1e3,1e3],function e(a,n,o){for(var i=0;i<a.length;i++){var h=a[i],f=h.tagName,d=h.getAttribute("fill");if(null==d&&(d=o),"g"==f){var l={crds:[],cmds:[]};e(h.children,l,d);var u=h.getAttribute("transform");if(u){var c=t(u);r.multArray(c,l.crds)}n.crds=n.crds.concat(l.crds),n.cmds=n.cmds.concat(l.cmds)}else if("path"==f||"circle"==f||"ellipse"==f){var v;if(n.cmds.push(d||"#000000"),"path"==f&&(v=h.getAttribute("d")),"circle"==f||"ellipse"==f){for(var p=[0,0,0,0],g=["cx","cy","rx","ry","r"],m=0;m<5;m++){var y=h.getAttribute(g[m]);y&&(y=parseFloat(y),m<4?p[m]=y:p[2]=p[3]=y)}var S=p[0],U=p[1],T=p[2],C=p[3];v=["M",S-T,U,"a",T,C,0,1,0,2*T,0,"a",T,C,0,1,0,2*-T,0].join(" ")}s(v,n),n.cmds.push("X")}}}(n.children,a);for(var i=0;i<a.crds.length;i+=2){var h=a.crds[i],f=a.crds[i+1];h-=o[0],f=-(f-=o[1]),a.crds[i]=h,a.crds[i+1]=f}return a}}}(),initHB:function(r,e){var t=function(r){var e=0;return 0==(4294967168&r)?e=1:0==(4294965248&r)?e=2:0==(4294901760&r)?e=3:0==(4292870144&r)&&(e=4),e},a=new window.TextEncoder("utf8");fetch(r).then((function(r){return r.arrayBuffer()})).then((function(r){return WebAssembly.instantiate(r)})).then((function(r){console.log("HB ready");var s=r.instance.exports,o=s.memory;o.grow(700);var i,h,f,d,l,u=new Uint8Array(o.buffer),c=new Uint32Array(o.buffer),v=new Int32Array(o.buffer);n.U.shapeHB=function(r,e,n){var o=r._data,p=r.name.postScriptName;i!=p&&(null!=h&&(s.hb_blob_destroy(h),s.free(f),s.hb_face_destroy(d),s.hb_font_destroy(l)),f=s.malloc(o.byteLength),u.set(o,f),h=s.hb_blob_create(f,o.byteLength,2,0,0),d=s.hb_face_create(h,0),l=s.hb_font_create(d),i=p);var g=s.hb_buffer_create(),m=a.encode(e),y=m.length,S=s.malloc(y);u.set(m,S),s.hb_buffer_add_utf8(g,S,y,0,y),s.free(S),s.hb_buffer_set_direction(g,n?4:5),s.hb_buffer_guess_segment_properties(g),s.hb_shape(l,g,0,0);var U=function(r){for(var e=s.hb_buffer_get_length(r),t=[],a=s.hb_buffer_get_glyph_infos(r,0)>>>2,n=s.hb_buffer_get_glyph_positions(r,0)>>>2,o=0;o<e;++o){var i=a+5*o,h=n+5*o;t.push({g:c[i+0],cl:c[i+2],ax:v[h+0],ay:v[h+1],dx:v[h+2],dy:v[h+3]})}return t}(g);s.hb_buffer_destroy(g);var T=U.slice(0);n||T.reverse();for(var C=0,b=0,x=1;x<T.length;x++){for(var F=T[x],w=F.cl;;){var B=e.codePointAt(C),M=t(B);if(!(b+M<=w))break;b+=M,C+=B<=65535?1:2}F.cl=C}return U},e()}))}};class s{constructor(r){a.set(this,void 0),function(r,e,t,a,n){if("m"===a)throw new TypeError("Private method is not writable");if("a"===a&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?r!==e||!n:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");"a"===a?n.call(r,t):n?n.value=t:e.set(r,t)}(this,a,n.parse(r)[0],"f")}static async fromUrl(r){return new s(await(await fetch(r)).arrayBuffer())}outline(t,s={}){const o=s.size??100,i=s.isLTR??!0,h=s.isCCW??!1,f=e(this,a,"f"),d=n.U.shape(f,t,i),{cmds:l,crds:u}=n.U.shapeToPath(f,d),c=new r,v=o/f.head.unitsPerEm;let p=0;for(const r of l)switch(r){case"M":c.moveTo(u[p++]*v,u[p++]*v);break;case"L":c.lineTo(u[p++]*v,u[p++]*v);break;case"Q":c.quadraticCurveTo(u[p++]*v,u[p++]*v,u[p++]*v,u[p++]*v);break;case"C":c.bezierCurveTo(u[p++]*v,u[p++]*v,u[p++]*v,u[p++]*v,u[p++]*v,u[p++]*v)}const g=c.toShapes(h),m=(f.head.yMax-f.head.yMin)*v,y=d.reduce(((r,e)=>r+e.ax),0)*v,S=f.head.yMax*v;return{shapes:g,h:m,w:y,yMin:f.head.yMin*v,yMax:S}}hasGlyph(r){return n.U.codeToGlyph(e(this,a,"f"),r)>0}}a=new WeakMap;export{s as FontOutliner};
//# sourceMappingURL=FontOutliner.js.map
