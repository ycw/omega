{"version":3,"file":"Spring.js","sources":["../src/Spring/Spring.ts"],"sourcesContent":["import { Vector3 } from 'three';\r\n\r\nexport class Spring {\r\n\r\n  from: Vector3;\r\n  to: Vector3;\r\n  frequency: number;\r\n  decay: number; // 1=forever 0=instant\r\n  maxAmplitude: number; // |from-to| < maxAmplitude (0=instant)\r\n  position: Vector3; // hold curr pos\r\n  #isIdle!: boolean;\r\n  #time!: number; // curr time\r\n\r\n  constructor({\r\n    from = new Vector3(),\r\n    to = new Vector3(),\r\n    frequency = 10,\r\n    decay = 0.5,\r\n    maxAmplitude = Infinity,\r\n    position = new Vector3()\r\n  } = {}) {\r\n    this.from = from;\r\n    this.to = to;\r\n    this.frequency = frequency;\r\n    this.decay = decay;\r\n    this.maxAmplitude = maxAmplitude;\r\n    this.position = position;\r\n    this.reset();\r\n  }\r\n\r\n  reset() {\r\n    this.position.copy(this.from);\r\n    this.#isIdle = false;\r\n    this.#time = 0;\r\n  }\r\n\r\n  get isIdle() { return this.#isIdle }\r\n\r\n  update(dt: number) { // dt in sec\r\n    this.#isIdle = false;\r\n    this.#time += dt;\r\n    if (this.frequency === 0 || this.decay === 0) return this.#forceEnd();\r\n    const f = this.frequency * this.#time;\r\n    const k = this.decay ** f;\r\n    const a = this.from.distanceTo(this.to) * k;\r\n    if (a < 0.001) return this.#forceEnd();\r\n    const n = Math.sin(2 * Math.PI * f + this.#time);\r\n    const l = Math.min(this.maxAmplitude, a) * n;\r\n    this.position.copy(this.to).add(this.to.clone().sub(this.from).setLength(l));\r\n  }\r\n\r\n  #forceEnd() {\r\n    this.position.copy(this.to);\r\n    this.#isIdle = true;\r\n  }\r\n}"],"names":["Spring","from","to","frequency","decay","maxAmplitude","position","isIdle","time","constructor","Vector3","Infinity","this","reset","copy","update","dt","forceEnd","f","k","a","distanceTo","n","Math","sin","PI","l","min","add","clone","sub","setLength"],"mappings":"sCAEaA,EAEXC,KACAC,GACAC,UACAC,MACAC,aACAC,SACAC,GACAC,GAEAC,aAAYR,KACVA,EAAO,IAAIS,EAASR,GACpBA,EAAK,IAAIQ,EAASP,UAClBA,EAAY,GAAEC,MACdA,EAAQ,GAAGC,aACXA,EAAeM,EAAAA,EAAQL,SACvBA,EAAW,IAAII,GACb,IACFE,KAAKX,KAAOA,EACZW,KAAKV,GAAKA,EACVU,KAAKT,UAAYA,EACjBS,KAAKR,MAAQA,EACbQ,KAAKP,aAAeA,EACpBO,KAAKN,SAAWA,EAChBM,KAAKC,QAGPA,QACED,KAAKN,SAASQ,KAAKF,KAAKX,MACxBW,MAAKL,GAAU,EACfK,MAAKJ,EAAQ,EAGXD,aAAW,OAAOK,MAAKL,EAE3BQ,OAAOC,GAGL,GAFAJ,MAAKL,GAAU,EACfK,MAAKJ,GAASQ,EACS,IAAnBJ,KAAKT,WAAkC,IAAfS,KAAKR,MAAa,OAAOQ,MAAKK,IAC1D,MAAMC,EAAIN,KAAKT,UAAYS,MAAKJ,EAC1BW,EAAIP,KAAKR,OAASc,EAClBE,EAAIR,KAAKX,KAAKoB,WAAWT,KAAKV,IAAMiB,EAC1C,GAAIC,EAAI,KAAO,OAAOR,MAAKK,IAC3B,MAAMK,EAAIC,KAAKC,IAAI,EAAID,KAAKE,GAAKP,EAAIN,MAAKJ,GACpCkB,EAAIH,KAAKI,IAAIf,KAAKP,aAAce,GAAKE,EAC3CV,KAAKN,SAASQ,KAAKF,KAAKV,IAAI0B,IAAIhB,KAAKV,GAAG2B,QAAQC,IAAIlB,KAAKX,MAAM8B,UAAUL,IAG3ET,KACEL,KAAKN,SAASQ,KAAKF,KAAKV,IACxBU,MAAKL,GAAU"}